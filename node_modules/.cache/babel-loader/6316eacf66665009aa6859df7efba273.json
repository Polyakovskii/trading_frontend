{"ast":null,"code":"var _jsxFileName = \"/home/alexandr/PycharmProjects/\\u0421\\u0442\\u0430\\u0436\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430/frontend/src/Watchlist.js\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport Item from \"./components/item\";\nimport { Redirect } from \"react-router-dom\";\n\nclass AddWatchlist extends React.Component {\n  constructor(props) {\n    super(props);\n    this.addToWatchlist = this.addToWatchlist.bind(this);\n  }\n\n  addToWatchlist(ItemId) {\n    axios.post('http://localhost:8000/api/v1/watchlist/', {\n      item: ItemId\n    }, {\n      headers: {\n        Authorization: localStorage.getItem('trading_api_token')\n      }\n    });\n  }\n\n  render() {\n    const itemsNotInWatchlist = this.props.items.filter(item => {\n      return !this.props.watchlist.find(watchlist => watchlist.item.id == item.id);\n    });\n    const content = itemsNotInWatchlist.map(item => /*#__PURE__*/React.createElement(\"div\", {\n      key: item.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Item, {\n      item: item,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => this.addToWatchlist(item.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 17\n      }\n    }, \"Add to watchlist\")));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 13\n      }\n    }, content);\n  }\n\n}\n\nclass WatchlistView extends React.Component {\n  render() {\n    console.log(this.props.watchlist);\n    const content = this.props.watchlist.map(item => /*#__PURE__*/React.createElement(Item, {\n      item: item.item,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 13\n      }\n    }));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 13\n      }\n    }, content);\n  }\n\n}\n\nclass Watchlist extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      watchlist: [],\n      items: [],\n      isAdding: false,\n      authorized: !!localStorage.getItem(\"trading_api_token\")\n    };\n    this.changeIsAdding = this.changeIsAdding.bind(this);\n\n    if (this.state.authorized) {\n      axios.get('http://localhost:8000/api/v1/watchlist/', {\n        headers: {\n          Authorization: localStorage.getItem('trading_api_token')\n        }\n      }).then(response => this.setState({\n        watchlist: response.data\n      })).catch(err => {\n        if (err.response) {\n          if (err.response.status === 401) {\n            this.setState({\n              authorized: false\n            });\n          } else console.log(err.response);\n        } else console.log(err);\n      });\n      axios.get('http://localhost:8000/api/v1/items/', {\n        headers: {\n          Authorization: localStorage.getItem('trading_api_token')\n        }\n      }).then(response => this.setState({\n        items: response.data\n      })).catch(err => console.log(err));\n    }\n  }\n\n  changeIsAdding() {\n    this.setState({\n      isAdding: !this.state.isAdding\n    });\n  }\n\n  render() {\n    if (!this.state.authorized) return /*#__PURE__*/React.createElement(Redirect, {\n      to: {\n        pathname: \"/login\",\n        state: {\n          referrer: this.props.location.pathname\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 44\n      }\n    });\n\n    if (this.state.isAdding) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(AddWatchlist, {\n        watchlist: this.state.watchlist,\n        items: this.state.items,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: this.changeIsAdding,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 21\n        }\n      }, \"Back to watchlist\"));\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(WatchlistView, {\n        watchlist: this.state.watchlist,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: this.changeIsAdding,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }\n      }, \"Add item to watchlist\"));\n    }\n  }\n\n}\n\nexport { Watchlist };","map":{"version":3,"sources":["/home/alexandr/PycharmProjects/Стажировка/frontend/src/Watchlist.js"],"names":["React","axios","Item","Redirect","AddWatchlist","Component","constructor","props","addToWatchlist","bind","ItemId","post","item","headers","Authorization","localStorage","getItem","render","itemsNotInWatchlist","items","filter","watchlist","find","id","content","map","WatchlistView","console","log","Watchlist","state","isAdding","authorized","changeIsAdding","get","then","response","setState","data","catch","err","status","pathname","referrer","location"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport Item from \"./components/item\";\nimport {Redirect} from \"react-router-dom\";\n\nclass AddWatchlist extends React.Component{\n    constructor(props) {\n        super(props);\n        this.addToWatchlist = this.addToWatchlist.bind(this)\n    }\n\n    addToWatchlist(ItemId){\n        axios\n            .post('http://localhost:8000/api/v1/watchlist/', {\n            item: ItemId\n        },\n                {\n                    headers: {\n                        Authorization: localStorage.getItem('trading_api_token')\n                    }\n                }\n        )\n    }\n\n    render() {\n        const itemsNotInWatchlist = this.props.items.filter(item => {\n            return !this.props.watchlist.find(watchlist => watchlist.item.id == item.id);\n        })\n        const content = itemsNotInWatchlist.map((item) =>\n            <div key={item.id}>\n                <Item item={item} />\n                <button onClick={() => this.addToWatchlist(item.id)}>Add to watchlist</button>\n            </div>\n        )\n        return (\n            <div>\n                {content}\n            </div>\n        )\n    }\n}\n\n\nclass WatchlistView extends React.Component{\n    render(){\n        console.log(this.props.watchlist)\n        const content = this.props.watchlist.map((item) =>\n            <Item item={item.item} />\n        )\n        return (\n            <div>\n                {content}\n            </div>\n        )\n    }\n}\n\n\nclass Watchlist extends React.Component{\n    constructor(props) {\n        super(props);\n        this.state = {\n            watchlist: [],\n            items: [],\n            isAdding : false,\n            authorized: !!(localStorage.getItem(\"trading_api_token\"))\n        }\n        this.changeIsAdding = this.changeIsAdding.bind(this)\n        if (this.state.authorized) {\n            axios\n                .get('http://localhost:8000/api/v1/watchlist/', {\n                    headers: {\n                        Authorization: localStorage.getItem('trading_api_token')\n                    }\n                })\n                .then(response => this.setState({watchlist: response.data}))\n                .catch(err => {\n                    if (err.response) {\n                        if (err.response.status === 401) {\n                            this.setState({authorized: false})\n                        } else console.log(err.response)\n\n                    } else console.log(err)\n                })\n            axios\n                .get('http://localhost:8000/api/v1/items/', {\n                    headers: {\n                        Authorization: localStorage.getItem('trading_api_token')\n                    }\n                })\n                .then(response => this.setState({items: response.data}))\n                .catch(err => console.log(err))\n        }\n    }\n\n    changeIsAdding(){\n        this.setState({isAdding: !this.state.isAdding})\n    }\n\n   render(){\n        if (!this.state.authorized) return <Redirect\n            to={{\n                pathname: \"/login\",\n                state: {referrer: this.props.location.pathname}\n            }} />\n        if (this.state.isAdding){\n            return (\n                <div>\n                    <AddWatchlist watchlist={this.state.watchlist} items={this.state.items}/>\n                    <button onClick={this.changeIsAdding}>Back to watchlist</button>\n                </div>\n            )\n        }\n        else {\n            return (\n                <div>\n                    <WatchlistView watchlist={this.state.watchlist} />\n                    <button onClick={this.changeIsAdding}>Add item to watchlist</button>\n                </div>\n            )\n        }\n   }\n}\n\n\nexport {\n    Watchlist\n}"]},"metadata":{},"sourceType":"module"}